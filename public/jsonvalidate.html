<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JSON Validator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <style>
    #result {
      margin-top: 20px;
      font-size: 24px;
      font-weight: bold;
      background-color: #e0e0e0;
      padding: 15px;
      border-radius: 5px;
      border: 2px solid #4CAF50;
    }

    #errors {
      color: #D32F2F;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="container my-5">

    <h1 class="display-3">JSON Validator</h1>
    <form>
      <p><textarea name="json" class="form-control" placeholder="Paste your JSON array here..." rows="6"></textarea></p>
      <p><button class="btn btn-success">Validate</button></p>
    </form>

    <div id="errors"></div>
    <div id="result"></div>

    <h2 class="text-success mt-3">Processed JSON</h2>
    <pre id="processedJson" class="rounded text-bg-secondary p-2" style="white-space: pre-wrap"></pre>

    <div id="description">
      <h2>How it works:</h2>
      <p>This app validates a JSON array of objects with the following requirements:</p>
      <ul>
        <li>The input must be an array of exactly 20 objects.</li>
        <li>Each object may only contain these top-level keys (all optional): fn, bday, email, tel, adr, org, title, photo, url, nickname.</li>
        <li>All values must be strings, except for 'adr' which must be an object.</li>
        <li>If present, 'bday' must be in the YYYY-MM-DD format.</li>
        <li>If present, 'tel' must be in the nnn-nnn-nnnn format.</li>
        <li>If present, 'adr' must contain a "country-name" key.</li>
      </ul>
      <p>The app then processes each valid object by:</p>
      <ol>
        <li>Sorting keys within each object</li>
        <li>Removing all non-alphanumeric characters from string values</li>
        <li>Converting all string values to lowercase</li>
        <li>Dropping keys with empty string values</li>
      </ol>
      <p>Finally, it displays any errors, the processed JSON, calculates the SHA-256 hash of the processed JSON (indented with 2 spaces), converts it to a decimal number, and displays the last 5 digits as the validation code.</p>
    </div>
  </div>

  <script type="module" src="jsonvalidate.js"></script>
</body>

</html>
